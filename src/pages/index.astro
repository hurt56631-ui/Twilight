---
import GridLayout from "@layouts/grid.astro";

const pinyinNav = [
  { name: "ဗျည်းများ", sub: "Initials", icon: "initials", href: "/pinyin/initials", accent: "#2563eb", soft: "rgba(37,99,235,.14)" },
  { name: "သရများ", sub: "Finals", icon: "finals", href: "/pinyin/finals", accent: "#059669", soft: "rgba(5,150,105,.14)" },
  { name: "ပေါင်းစပ်ဖတ်နည်း", sub: "Syllables", icon: "syllables", href: "/pinyin/syllables", accent: "#9333ea", soft: "rgba(147,51,234,.14)" },
  { name: "အသံအနိမ့်အမြင့်", sub: "Tones", icon: "tones", href: "/pinyin/tones", accent: "#ea580c", soft: "rgba(234,88,12,.14)" },
];

const coreTools = [
  { title: "AI ဘာသာပြန်", sub: "AI Translate", icon: "ai", href: "/ai-translate", accent: "#4f46e5", soft: "rgba(79,70,229,.14)" },
  { title: "အခမဲ့စာအုပ်များ", sub: "Library", icon: "library", href: "/library", accent: "#0f766e", soft: "rgba(15,118,110,.14)" },
  { title: "စကားလုံးစုဆောင်းခြင်း", sub: "Words", icon: "star", href: "/words", accent: "#b45309", soft: "rgba(180,83,9,.14)" },
  { title: "အသုံးအနှုန်းစုများ", sub: "Oral", icon: "mic", href: "/oral", accent: "#be123c", soft: "rgba(190,18,60,.14)" },
];

const studyPaths = [
  { title: "အဓိကစကားလုံးများ", icon: "pathWords", desc: "HSK အခြေခံ စကားလုံးများကို လေ့လာပါ။", count: "၁၂၅၀ လုံး", href: "/path/words", accent: "#2563eb" },
  { title: "အခြေအနေနှင့်ဆိုင်သော စကားပြော", icon: "pathOral", desc: "နေ့စဉ်သုံး စကားပြောဆိုမှုများကို လေ့ကျင့်ပါ။", count: "၄၈ ခန်း", href: "/path/oral", accent: "#059669" },
  { title: "သဒ္ဒါအချက်များ", icon: "pathGrammar", desc: "တရုတ်ဘာသာစကား၏ သဒ္ဒါစည်းမျဉ်းများကို နားလည်စေရန်။", count: "၁၂ ချက်", href: "/path/grammar", accent: "#d97706" },
];

const iconMap = {
  initials: { viewBox: "0 0 24 24", paths: ["M5 19h14", "M8 19l4-14 4 14", "M9.7 13h4.6"] },
  finals: { viewBox: "0 0 24 24", paths: ["M4 10c2-2 4-2 6 0s4 2 6 0 4-2 4-2", "M4 15c2-2 4-2 6 0s4 2 6 0 4-2 4-2"] },
  syllables: { viewBox: "0 0 24 24", paths: ["M6 6h5v5H6z", "M13 6h5v5h-5z", "M6 13h5v5H6z", "M13 13h5v5h-5z"] },
  tones: { viewBox: "0 0 24 24", paths: ["M6 4v16", "M12 4v16", "M18 4v16", "M4 9h4", "M10 14h4", "M16 7h4"] },
  ai: { viewBox: "0 0 24 24", paths: ["M12 3l1.8 4.2L18 9l-4.2 1.8L12 15l-1.8-4.2L6 9l4.2-1.8L12 3z", "M19 14l.9 2.1L22 17l-2.1.9L19 20l-.9-2.1L16 17l2.1-.9L19 14z"] },
  library: { viewBox: "0 0 24 24", paths: ["M4 6.5A2.5 2.5 0 0 1 6.5 4H11v15H6.5A2.5 2.5 0 0 1 4 16.5z", "M20 6.5A2.5 2.5 0 0 0 17.5 4H13v15h4.5a2.5 2.5 0 0 0 2.5-2.5z"] },
  star: { viewBox: "0 0 24 24", paths: ["M12 3l2.7 5.5 6.1.9-4.4 4.3 1 6.1L12 17l-5.4 2.8 1-6.1L3.2 9.4l6.1-.9z"] },
  mic: { viewBox: "0 0 24 24", paths: ["M12 4a3 3 0 0 1 3 3v4a3 3 0 0 1-6 0V7a3 3 0 0 1 3-3z", "M7 11a5 5 0 0 0 10 0", "M12 16v4", "M9 20h6"] },
  pathWords: { viewBox: "0 0 24 24", paths: ["M6 4h9l3 3v13H6z", "M15 4v3h3", "M9 12h6", "M9 16h6"] },
  pathOral: { viewBox: "0 0 24 24", paths: ["M4 5h16v10H8l-4 4z", "M9 9h6", "M9 12h4"] },
  pathGrammar: { viewBox: "0 0 24 24", paths: ["M9 18h6", "M10 14h4", "M12 3a6 6 0 0 0-3.8 10.6c.9.8 1.8 1.7 1.8 2.9h4c0-1.2.9-2.1 1.8-2.9A6 6 0 0 0 12 3z"] },
};

const getIcon = (name) => iconMap[name] || iconMap.initials;
---

<GridLayout title="Chinese Learning Hub">
  <main class="relative mx-auto max-w-5xl px-4 pb-14 pt-8">
    
    <!-- Hero Section -->
    <section class="glass-card hero-card card-in" style="animation-delay: 0ms;">
      <div class="flex flex-col justify-center">
        <!-- 渐变色高颜值标题 -->
        <h1 class="text-3xl font-black leading-tight tracking-tight sm:text-4xl bg-clip-text text-transparent bg-gradient-to-br from-slate-900 via-indigo-800 to-slate-600 burmese-text">
          တရုတ်ဘာသာစကား လေ့လာရန်
          <span class="block text-lg mt-1 font-extrabold text-indigo-600 tracking-wide">Chinese Learning Hub</span>
        </h1>
        <p class="mt-3 max-w-2xl text-sm leading-relaxed text-slate-600 sm:text-base font-medium">
          Initials · Finals · Syllables · Tones · Vocabulary · Grammar
        </p>
        <div class="mt-6 flex flex-wrap gap-3">
          <a href="/pinyin/initials" class="btn btn-primary">Start Pinyin</a>
          <a href="/ai-translate" class="btn btn-ghost">Open AI Translate</a>
        </div>
      </div>
      <div class="hero-kpi flex flex-col items-center justify-center">
        <div class="kpi-ring relative">
          <span class="relative z-10 text-xl font-black text-indigo-900">63%</span>
        </div>
        <p class="mt-3 text-center text-[10px] font-bold uppercase tracking-[0.25em] text-slate-500">Weekly Goal</p>
      </div>
    </section>

    <!-- Pinyin Navigation -->
    <section class="mt-8 grid grid-cols-2 gap-4 sm:grid-cols-4">
      {pinyinNav.map((item, index) => {
        const icon = getIcon(item.icon);
        return (
          <a href={item.href} class="pinyin-card card-in group" style={`--accent:${item.accent};--soft:${item.soft}; animation-delay: ${index * 75 + 100}ms;`}>
            <div class="pinyin-icon-wrap transition-transform duration-300 group-hover:scale-110">
              <svg viewBox={icon.viewBox} class="svg-icon" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                {icon.paths.map((d) => <path d={d}></path>)}
              </svg>
            </div>
            <p class="pinyin-name burmese-text">{item.name}</p>
            <p class="pinyin-sub">{item.sub}</p>
          </a>
        );
      })}
    </section>

    <!-- Core Tools -->
    <section class="mt-8 grid grid-cols-2 gap-4">
      {coreTools.map((tool, index) => {
        const icon = getIcon(tool.icon);
        return (
          <a href={tool.href} class="tool card-in group" style={`--accent:${tool.accent};--soft:${tool.soft}; animation-delay: ${index * 75 + 300}ms;`}>
            <div class="tool-icon-wrap transition-transform duration-300 group-hover:-translate-y-1">
              <svg viewBox={icon.viewBox} class="svg-icon" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                {icon.paths.map((d) => <path d={d}></path>)}
              </svg>
            </div>
            <h3 class="tool-title burmese-text">{tool.title}</h3>
            <p class="tool-sub">{tool.sub}</p>
          </a>
        );
      })}
    </section>

    <!-- Learning Paths -->
    <section class="mt-12 card-in" style="animation-delay: 600ms;">
      <div class="mb-5 flex items-end justify-between px-1">
        <h2 class="section-title burmese-text">သင်ယူမှုလမ်းကြောင်း <span class="text-slate-300 font-normal ml-2 text-sm hidden sm:inline">/ Learning Path</span></h2>
        <a href="/path" class="text-xs font-bold text-slate-800 bg-white/50 px-3 py-1.5 rounded-full hover:bg-white transition-colors backdrop-blur-md">View All</a>
      </div>
      <div class="flex flex-col gap-4">
        {studyPaths.map((path, index) => {
          const icon = getIcon(path.icon);
          return (
            <a href={path.href} class="path-card group" style={`--accent:${path.accent};`}>
              <div class="path-icon transition-transform duration-300 group-hover:scale-105 group-hover:shadow-md">
                <svg viewBox={icon.viewBox} class="svg-icon" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                  {icon.paths.map((d) => <path d={d}></path>)}
                </svg>
              </div>
              <div class="min-w-0 flex-1">
                <div class="mb-1.5 flex items-center justify-between gap-3">
                  <h4 class="truncate text-base font-black text-slate-900 sm:text-lg burmese-text">{path.title}</h4>
                  <span class="path-count burmese-text">{path.count}</span>
                </div>
                <p class="text-xs text-slate-600 sm:text-sm burmese-text leading-relaxed">{path.desc}</p>
              </div>
              <div class="path-arrow-bg ml-2 hidden sm:flex">
                <svg class="path-arrow" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true">
                  <path fill="currentColor" d="M12.6 12L8 7.4L9.4 6l6 6l-6 6L8 16.6z" />
                </svg>
              </div>
            </a>
          );
        })}
      </div>
    </section>
  </main>
</GridLayout>

<style is:global>
  :root {
    --glass: rgba(255, 255, 255, 0.76);
    --glass-strong: rgba(255, 255, 255, 0.9);
    --glass-border: rgba(255, 255, 255, 0.6);
  }

  body {
    background: url("/assets/images/desktopWallpaper_1.jpg") center / cover fixed no-repeat;
    font-family: "Noto Sans Myanmar", "Manrope", "Segoe UI", sans-serif;
  }

  /* 添加底层遮罩，确保玻璃态内容在任何壁纸下都清晰可见 */
  body::before {
    content: "";
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: -1;
    background:
      radial-gradient(circle at 10% 0%, rgba(79, 70, 229, 0.15), transparent 40%),
      radial-gradient(circle at 90% 100%, rgba(16, 185, 129, 0.1), transparent 50%),
      linear-gradient(135deg, rgba(248, 250, 252, 0.4), rgba(226, 232, 240, 0.1));
    backdrop-filter: blur(8px); /* 轻微模糊背景图片 */
  }

  /* 针对缅文特有的行高优化，防止上下截断 */
  .burmese-text {
    line-height: 1.65;
    padding-top: 2px;
  }

  #sidebar-left,
  #sidebar-right {
    display: none !important;
  }
</style>

<style>
  .glass-card {
    border: 1px solid var(--glass-border);
    background: var(--glass);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1);
  }

  .hero-card {
    display: grid;
    gap: 1.5rem;
    grid-template-columns: 1fr;
    border-radius: 2rem;
    padding: 1.5rem;
    position: relative;
    overflow: hidden;
  }

  /* 给Hero卡片加点光感 */
  .hero-card::after {
    content: "";
    position: absolute;
    top: 0; right: 0;
    width: 200px; height: 200px;
    background: radial-gradient(circle, rgba(79, 70, 229, 0.1) 0%, transparent 70%);
    pointer-events: none;
  }

  .hero-kpi { justify-self: center; }

  .kpi-ring {
    width: 96px;
    height: 96px;
    border-radius: 50%;
    display: grid;
    place-items: center;
    background: conic-gradient(#4f46e5 0 226deg, rgba(79, 70, 229, 0.1) 226deg 360deg);
    box-shadow: 0 8px 24px -6px rgba(79, 70, 229, 0.3);
  }

  .kpi-ring::before {
    content: "";
    position: absolute;
    inset: 7px;
    border-radius: 50%;
    background: #fff;
    box-shadow: inset 0 2px 6px rgba(0,0,0,0.05);
  }

  .btn {
    display: inline-flex;
    align-items: center;
    border-radius: 999px;
    padding: 0.65rem 1.25rem;
    font-size: 0.85rem;
    font-weight: 800;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .btn-primary {
    background: #1e1b4b;
    color: #fff;
    box-shadow: 0 8px 20px -6px rgba(30, 27, 75, 0.4);
  }
  .btn-primary:hover {
    background: #312e81;
    transform: translateY(-2px);
    box-shadow: 0 12px 24px -6px rgba(30, 27, 75, 0.5);
  }

  .btn-ghost {
    border: 1px solid rgba(15, 23, 42, 0.1);
    background: rgba(255, 255, 255, 0.8);
    color: #1e293b;
  }
  .btn-ghost:hover {
    background: #fff;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px -6px rgba(0, 0, 0, 0.1);
  }

  .pinyin-card {
    border: 1px solid var(--glass-border);
    background: var(--glass);
    backdrop-filter: blur(16px);
    border-radius: 1.25rem;
    text-decoration: none;
    text-align: center;
    padding: 1.2rem 0.5rem;
    box-shadow: 0 4px 15px -3px rgba(0, 0, 0, 0.05);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .pinyin-card:hover {
    transform: translateY(-4px);
    background: #fff;
    /* 引入基于变量的发光效果 */
    box-shadow: 0 14px 28px -6px rgba(2, 6, 23, 0.1), 0 0 20px var(--soft);
    border-color: transparent;
  }

  .pinyin-icon-wrap {
    width: 48px;
    height: 48px;
    margin: 0 auto 0.6rem;
    border-radius: 14px;
    display: grid;
    place-items: center;
    background: var(--soft);
    color: var(--accent);
    border: 1px solid rgba(255, 255, 255, 0.8);
  }

  .pinyin-name {
    font-size: 0.85rem;
    font-weight: 800;
    color: #0f172a;
  }

  .pinyin-sub {
    font-size: 0.65rem;
    font-weight: 800;
    letter-spacing: 0.08em;
    color: #64748b;
    text-transform: uppercase;
  }

  .tool {
    border: 1px solid var(--glass-border);
    background: var(--glass);
    backdrop-filter: blur(16px);
    border-radius: 1.5rem;
    padding: 1.2rem 1rem;
    text-align: center;
    text-decoration: none;
    box-shadow: 0 4px 15px -3px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .tool::before {
    content: "";
    position: absolute;
    inset: 0 auto auto 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, var(--accent), transparent);
    opacity: 0.8;
    transition: opacity 0.3s ease;
  }

  .tool:hover {
    transform: translateY(-4px);
    background: #fff;
    box-shadow: 0 16px 30px -8px rgba(2, 6, 23, 0.15), 0 0 24px var(--soft);
  }
  .tool:hover::before { opacity: 1; }

  .tool-icon-wrap {
    width: 54px;
    height: 54px;
    margin: 0 auto 0.75rem;
    border-radius: 16px;
    display: grid;
    place-items: center;
    background: var(--soft);
    color: var(--accent);
    border: 1px solid rgba(255, 255, 255, 0.8);
  }

  .svg-icon {
    width: 26px;
    height: 26px;
  }

  .tool-title {
    font-size: 0.95rem;
    font-weight: 900;
    color: #0f172a;
  }

  .tool-sub {
    font-size: 0.7rem;
    letter-spacing: 0.1em;
    font-weight: 800;
    text-transform: uppercase;
    color: #64748b;
  }

  .section-title {
    font-size: 1.15rem;
    font-weight: 900;
    color: #f8fafc;
    text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
  }

  .path-card {
    border: 1px solid rgba(255,255,255,0.7);
    background: var(--glass-strong);
    backdrop-filter: blur(16px);
    border-radius: 1.25rem;
    padding: 1.1rem;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 1rem;
    box-shadow: 0 4px 15px -3px rgba(0, 0, 0, 0.05);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
  }

  .path-card::before {
    content: "";
    position: absolute;
    inset: 0 auto 0 0;
    width: 5px;
    background: var(--accent);
    border-radius: 4px 0 0 4px;
  }

  .path-card:hover {
    transform: translateY(-3px);
    background: #fff;
    box-shadow: 0 16px 34px -8px rgba(2, 6, 23, 0.15);
  }

  .path-icon {
    width: 56px;
    height: 56px;
    border-radius: 16px;
    display: grid;
    place-items: center;
    color: var(--accent);
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(0, 0, 0, 0.05);
    box-shadow: 0 4px 10px rgba(0,0,0,0.03);
  }

  .path-count {
    white-space: nowrap;
    border-radius: 999px;
    padding: 0.25rem 0.7rem;
    font-size: 0.7rem;
    font-weight: 900;
    color: var(--accent);
    background: rgba(248, 250, 252, 0.8);
    border: 1px solid rgba(0,0,0,0.05);
  }

  .path-arrow-bg {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background: #f1f5f9;
    align-items: center;
    justify-content: center;
    color: #94a3b8;
    transition: all 0.3s ease;
  }

  .path-card:hover .path-arrow-bg {
    background: var(--accent);
    color: #fff;
    transform: translateX(4px);
  }

  /* --- 级联加载动画 --- */
  .card-in {
    opacity: 0;
    animation: slideUpFade 600ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  @keyframes slideUpFade {
    0% { opacity: 0; transform: translateY(20px) scale(0.98); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
  }

  @media (min-width: 768px) {
    .hero-card {
      grid-template-columns: 1fr auto;
      align-items: center;
      padding: 2rem 2.5rem;
    }
    .hero-kpi { justify-self: end; }
  }
</style>
