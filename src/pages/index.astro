---
import GridLayout from "@layouts/grid.astro";

// 顶部 4 个拼音基础模块 (参考图1)
const pinyinNav = [
  { zh: "声母", mm: "ဗျည်း", icon: "mic", href: "/pinyin/initials", bg: "bg-blue-50/80", iconColor: "text-blue-600" },
  { zh: "韵母", mm: "သရ", icon: "music", href: "/pinyin/finals", bg: "bg-emerald-50/80", iconColor: "text-emerald-500" },
  { zh: "整体", mm: "အသံတွဲ", icon: "layers", href: "/pinyin/syllables", bg: "bg-purple-50/80", iconColor: "text-purple-600" },
  { zh: "声调", mm: "အသံ", icon: "document", href: "/pinyin/tones", bg: "bg-orange-50/80", iconColor: "text-orange-500" },
];

// 中间 4 个核心工具模块 (参考图1)
const coreTools = [
  { zh: "AI 翻译", mm: "AI ဘာသာပြန်", icon: "globe", href: "/ai-translate", bg: "bg-indigo-50/60", iconColor: "text-indigo-600" },
  { zh: "免费书籍", mm: "စာကြည့်တိုက်", icon: "books", href: "/library", bg: "bg-cyan-50/60", iconColor: "text-cyan-600" },
  { zh: "单词收藏", mm: "မှတ်ထားသော စာလုံး", icon: "star", href: "/words", bg: "bg-slate-50/80", iconColor: "text-slate-700" },
  { zh: "口语收藏", mm: "မှတ်ထားသော စကားပြော", icon: "speaker", href: "/oral", bg: "bg-slate-50/80", iconColor: "text-slate-700" },
];

// 底部带背景图的课程卡片 (参考图2)
const systemCourses = [
  { 
    badge1: "HSK 1", badge2: "2 Free", 
    sub: "入门 (INTRO)", title: "HSK 1", 
    mmDesc: "အသုံးအများဆုံး စကားလုံးများနှင့် သဒ္ဒါ", 
    zhDesc: "掌握最常用词语和基本语法", 
    // 使用高质量的占位图，你可以换成你自己的图片路径
    bgImg: "https://images.unsplash.com/photo-1548013146-72479768bada?auto=format&fit=crop&q=80&w=800",
    href: "/course/hsk1" 
  },
  { 
    badge1: "HSK 2", badge2: "Pro", 
    sub: "基础 (BASIC)", title: "HSK 2", 
    mmDesc: "နေ့စဉ်သုံး စကားပြောဆိုမှုများကို လေ့ကျင့်ပါ။", 
    zhDesc: "能够就日常话题进行简单交流", 
    bgImg: "https://images.unsplash.com/photo-1583805373066-cb9499158c56?auto=format&fit=crop&q=80&w=800",
    href: "/course/hsk2" 
  },
  { 
    badge1: "Spoken", badge2: "Hot", 
    sub: "口语 (ORAL)", title: "Daily Chinese", 
    mmDesc: "တရုတ်ဘာသာစကား၏ သဒ္ဒါစည်းမျဉ်းများ", 
    zhDesc: "高频生活口语与地道表达", 
    bgImg: "https://images.unsplash.com/photo-1552084117-56a98a938cce?auto=format&fit=crop&q=80&w=800",
    href: "/course/oral" 
  },
];

// 更精致的 App 风格 SVG 图标
const iconMap = {
  mic: { viewBox: "0 0 24 24", paths: ["M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z", "M19 10v2a7 7 0 0 1-14 0v-2", "M12 19v3"] },
  music: { viewBox: "0 0 24 24", paths: ["M9 18V5l12-2v13", "M9 9l12-2", "M6 15a3 3 0 1 0 3 3v-3H6Z", "M18 13a3 3 0 1 0 3 3v-3h-3Z"] },
  layers: { viewBox: "0 0 24 24", paths: ["M12 2L2 7l10 5 10-5-10-5Z", "M2 12l10 5 10-5", "M2 17l10 5 10-5"] },
  document: { viewBox: "0 0 24 24", paths: ["M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z", "M14 2v6h6", "M16 13H8", "M16 17H8", "M10 9H8"] },
  bulb: { viewBox: "0 0 24 24", paths: ["M9 18h6", "M10 22h4", "M15.09 14c.18-.98.65-1.74 1.41-2.5A6 6 0 1 0 8 4.92C6.35 6.2 5.56 8.35 6.07 10.34c.32 1.25.96 2.45 1.84 3.32.76.76 1.23 1.52 1.41 2.5"] },
  globe: { viewBox: "0 0 24 24", paths: ["M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z", "M2 12h20", "M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"] },
  books: { viewBox: "0 0 24 24", paths: ["M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20", "M8 7h6", "M8 11h8"] },
  star: { viewBox: "0 0 24 24", fill: "currentColor", stroke: "none", paths: ["M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"] },
  speaker: { viewBox: "0 0 24 24", fill: "currentColor", stroke: "none", paths: ["M11 5L6 9H2v6h4l5 4V5z", "M15.54 8.46a5 5 0 0 1 0 7.07", "M19.07 4.93a10 10 0 0 1 0 14.14"] },
};

const getIcon = (name) => iconMap[name] || iconMap.mic;
---

<GridLayout title="Chinese Learning Hub">
  <main class="relative mx-auto max-w-lg px-4 pb-16 pt-6"> <!-- max-w-lg 限制最大宽度，让它在电脑上看起来也像手机排版，更精致紧凑 -->
    
    <!-- 1. 顶部 4 宫格导航 -->
    <section class="grid grid-cols-4 gap-3">
      {pinyinNav.map((item, index) => {
        const icon = getIcon(item.icon);
        return (
          <a href={item.href} class={`app-card ${item.bg} flex flex-col items-center justify-center py-4 px-1 gap-2 hover:brightness-95 card-in`} style={`animation-delay: ${index * 50}ms;`}>
            <div class={`w-7 h-7 ${item.iconColor}`}>
              <svg viewBox={icon.viewBox} class="w-full h-full" fill={icon.fill || "none"} stroke={icon.stroke || "currentColor"} stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                {icon.paths.map((d) => <path d={d}></path>)}
              </svg>
            </div>
            <div class="text-center">
              <div class="text-[13px] font-bold text-slate-800 leading-none mb-1">{item.zh}</div>
              <div class="text-[10px] text-slate-500 font-medium leading-none burmese-text">{item.mm}</div>
            </div>
          </a>
        );
      })}
    </section>

    <!-- 2. 发音技巧 Banner -->
    <section class="mt-4 card-in" style="animation-delay: 200ms;">
      <a href="/tips" class="app-card bg-slate-50/80 flex items-center justify-between px-4 py-3 hover:bg-slate-100">
        <div class="flex items-center gap-3">
          <div class="w-6 h-6 text-orange-500">
            <svg viewBox={iconMap.bulb.viewBox} fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              {iconMap.bulb.paths.map((d) => <path d={d}></path>)}
            </svg>
          </div>
          <div>
            <div class="text-[14px] font-bold text-slate-800">发音技巧 (Tips)</div>
            <div class="text-[11px] text-slate-500 mt-0.5 burmese-text">အသံထွက်နည်းလမ်းများ</div>
          </div>
        </div>
        <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
      </a>
    </section>

    <!-- 3. 中间 2x2 工具区 -->
    <section class="mt-4 grid grid-cols-2 gap-3">
      {coreTools.map((tool, index) => {
        const icon = getIcon(tool.icon);
        return (
          <a href={tool.href} class={`app-card ${tool.bg} flex items-center gap-3 p-3.5 hover:brightness-95 card-in`} style={`animation-delay: ${index * 50 + 250}ms;`}>
            <div class={`w-6 h-6 flex-shrink-0 ${tool.iconColor}`}>
              <svg viewBox={icon.viewBox} class="w-full h-full" fill={icon.fill || "none"} stroke={icon.stroke || "currentColor"} stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                {icon.paths.map((d) => <path d={d}></path>)}
              </svg>
            </div>
            <div class="flex flex-col min-w-0">
              <span class="text-[14px] font-bold text-slate-800 truncate">{tool.zh}</span>
              <span class="text-[11px] text-slate-500 mt-0.5 truncate burmese-text">{tool.mm}</span>
            </div>
          </a>
        );
      })}
    </section>

    <!-- 4. System Courses (带背景图) -->
    <section class="mt-8">
      <div class="mb-3 px-1 flex items-center gap-2">
        <svg class="w-4 h-4 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg>
        <h2 class="text-[13px] font-bold text-slate-600 tracking-wider burmese-text">SYSTEM COURSES (သင်ရိုး)</h2>
      </div>
      
      <div class="flex flex-col gap-4">
        {systemCourses.map((course, index) => (
          <a href={course.href} class="course-card group card-in" style={`animation-delay: ${index * 100 + 450}ms;`}>
            <!-- 背景图 -->
            <img src={course.bgImg} alt={course.title} class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" />
            <!-- 渐变遮罩 (底部深色，保证白字清晰) -->
            <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent"></div>
            
            <div class="relative h-full flex flex-col justify-between p-4">
              <!-- 左上角 Badges -->
              <div class="flex gap-2">
                <span class="bg-white/90 text-slate-800 text-[11px] font-black px-2.5 py-1 rounded-full">{course.badge1}</span>
                <span class="bg-cyan-500 text-white text-[11px] font-black px-2.5 py-1 rounded-full">{course.badge2}</span>
              </div>
              
              <!-- 底部文字信息 -->
              <div class="mt-20">
                <p class="text-cyan-400 font-bold text-[12px] tracking-widest mb-1">{course.sub}</p>
                <h3 class="text-white font-black text-3xl mb-2">{course.title}</h3>
                <p class="text-slate-200 text-[13px] burmese-text mb-0.5 line-clamp-1">{course.mmDesc}</p>
                <p class="text-slate-300 text-[12px] font-medium line-clamp-1">{course.zhDesc}</p>
              </div>
            </div>
          </a>
        ))}
      </div>
    </section>
  </main>
</GridLayout>

<style is:global>
  body {
    background-color: #f8fafc; /* 使用非常干净的浅灰底色作为基底 */
    font-family: "Noto Sans Myanmar", "Manrope", "Segoe UI", sans-serif;
  }

  /* 修复缅文行高 */
  .burmese-text {
    line-height: 1.6;
  }
</style>

<style>
  /* 通用 App 卡片样式（超圆角、极淡阴影、毛玻璃） */
  .app-card {
    border-radius: 1.25rem; /* 对应 rounded-2xl */
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.6);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.02), inset 0 2px 4px rgba(255, 255, 255, 0.5);
    transition: all 0.2s ease;
  }

  /* 图片课程卡片专用样式 */
  .course-card {
    display: block;
    position: relative;
    width: 100%;
    border-radius: 1.25rem;
    overflow: hidden;
    min-height: 180px; /* 保证卡片有足够高度显示图片 */
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.1);
    transform: translateZ(0); /* 开启硬件加速，防止圆角在图片缩放时失效 */
  }

  /* 入场动画 */
  .card-in {
    opacity: 0;
    animation: slideUpFade 500ms cubic-bezier(0.16, 1, 0.3, 1) forwards;
  }

  @keyframes slideUpFade {
    0% { opacity: 0; transform: translateY(15px) scale(0.98); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
  }
</style>
